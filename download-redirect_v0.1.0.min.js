!function(){"use strict";(()=>{const e=["resintech.com","info.resintech.com","blog.resintech.com","resintech.webflow.io"],t=[".pdf",".doc",".docx",".xls",".xlsx",".zip"],o=10485760;const n=new URLSearchParams(window.location.search),r=n.get("url"),a=n.get("name");if(!r||!a)return alert("Invalid download link. Missing required parameters."),void window.history.back();const i=function(e){if((e=(e=(e=e.replace(/\.\./g,"")).replace(/[\/\\]/g,"")).replace(/[<>:"|?*]/g,"")).length>255){const t=e.match(/\.[^.]+$/)?.[0]||"";e=e.substring(0,255-t.length)+t}return e}(a);if(!function(t){try{const o=new URL(t);if("https:"!==o.protocol)return!1;return e.some(e=>o.hostname===e||o.hostname.endsWith("."+e))}catch(e){return!1}}(r))return alert("Download not allowed. Invalid source."),void window.history.back();if(!function(e){const o=e.toLowerCase().match(/\.[^.]+$/)?.[0];return o&&t.includes(o)}(i))return alert("File type not allowed."),void window.history.back();async function c(){try{document.body.style.cursor="wait";const e=await fetch(r,{method:"GET",mode:"cors",credentials:"same-origin",headers:{Accept:"application/pdf,application/octet-stream"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=e.headers.get("Content-Type");if(t&&!["application/pdf","application/octet-stream","application/msword","application/vnd.ms-excel","application/zip"].some(e=>t.includes(e)))throw new Error("Invalid file type received");const n=e.headers.get("Content-Length");if(n&&parseInt(n)>o)throw new Error("File too large");const a=await e.blob();if(a.size>o)throw new Error("File too large");const c=URL.createObjectURL(a),s=document.createElement("a");s.href=c,s.download=i,s.style.display="none",document.body.appendChild(s),s.click(),setTimeout(()=>{document.body.removeChild(s),URL.revokeObjectURL(c),document.body.style.cursor="default",window.history.back()},100)}catch(e){document.body.style.cursor="default",alert("Download failed. Please try again later."),window.history.back()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()})()}();
